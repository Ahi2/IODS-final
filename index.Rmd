---
title: "IODS-final"
author: "Mohamadali Ahi; mohamadali.ahi@helsinki.fi"
date: "15 joulukuuta 2017"
output:
  html_document:
    df_print: paged

---

In the assignment the follwing are going to be conducted: 

# hypotheses
The hypotheses are as follows:
H1. Gross National Income (GNP) per capita positively affects life expectancy at birth.

# Reading the data into R

We first start with the first hypothesis. For that, we need to read the human dataset which has been prepared [here](https://github.com/Ahi2/IODS-final/blob/master/create_human2.R), using data wrangling procedure as explained in the link.

Due to an error at the end of the data wrangling, I need to read the data again, calling it 'human2'. Then, I look at the dtructure, dimensions, and a summary of the dataset.

```{r}
human2 <- read.table("http://s3.amazonaws.com/assets.datacamp.com/production/course_2218/datasets/human2.txt", sep  =",", header = T)

str(human2)
dim(human2)
summary(human2)
```

Now, let us access the libraries we need.

```{r}
library(tidyr)

library(dplyr)

library(ggplot2)

library(GGally)

library(corrplot)
```


# 1. Multiple Linear Regression 

```{r}
ggpairs(human2)
```

```{r}
cor(human2) %>% corrplot
```


```{r}
qplot(GNI, Life.Exp, data = human2) + geom_smooth(method = "lm")

```

Removing outliers. 
```{r}
human2 <- filter(human2, GNI < 80000)
```


```{r}
qplot(GNI, Life.Exp, data = human2) + geom_smooth(method = "lm")

```


```{r}
my_model <- lm(Life.Exp ~ GNI, data = human2) 
summary(my_model)
```


```{r}
my_model2 <- lm(Life.Exp ~ GNI + Mat.Mor, data = human2)
summary(my_model2)
```


```{r}
par(mfrow = c(2,2))
plot(my_model2, which = c(1,2,5))
```


